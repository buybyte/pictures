<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="911px" height="321px" viewBox="-0.5 -0.5 911 321" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2021-07-21T00:52:07.278Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36&quot; etag=&quot;RGz38tnsJ0Lx_DeJY0lb&quot; version=&quot;14.9.0&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;-ejv2YcwAvHS86lBRQgP&quot; name=&quot;Page-1&quot;&gt;5Vpbc6s2EP41mmkfjgfE/REcSB/aTmby0NOnDDGyocXII8uJfX59d4UAY4gdnziXJs5DpJW0Wn3frnYVh1jT5fZapKv8D56xklAj2xLrilBqGpYPv1CyqyWO7dWChSgyPakT3BY/WLNSSzdFxta9iZLzUharvnDGq4rNZE+WCsEf+9PmvOzvukoXbCC4naXlUPpXkcm8lvrU6+S/sWKRNzubblCPLNNmsj7JOk8z/rgnsmJiTQXnsm4tt1NWIngNLvW65InR1jDBKvmcBau7yM68H/GfTnodBru78C5PvmktD2m50QfWxspdg4DgmypjqMQgVvSYF5LdrtIZjj4C5yDL5bKEngnNoVHNDkxItt0TaSOvGV8yKXYwpRl1NWDaY6iv+48d/rahZfke9s28VFO+aFV3qEBDA3MGSO4AE5aBk+guFzLnC16lZdxJoz5q3ZzfOV9prP5hUu60x6cbyftIAoBi9x3XT6jT9P/W+lTnatvr7XTvSQrWfCNm7Mg5LR1fqVgwedppEISjhApWprJ46EfSxdmxznFh801cmBp9Fx7xYJO+pQd77+zBpmOf48Kqd8NEAadn4sV+7VzaX/XSG16AKS3rtmtMDDp+dzVa6tjSCw9IbS35eZ6djxcL9keLBX+AEZYAYAK2DZv+QmKbRD6Jol8H4MGZZR+htRT8XzblJRdqiuWqD4zMi7Lck88d/AF5WhaLCmQzwBSdO0IsC6g4Qj2wLLJMReAYOf2onPNK7u1Rfy50hwVOjzfLcIbENbJ94iznlYgLBsTJXLA0M8+mqeIVO2BIiy5JziVIoH0S7GHweCOxQ18rdpqqfMDB8J75NBzYH4wD+j7JfFvI73ttlcYnju51eRw7vTReFwDeWSXs4FJNEgM+7UjzErOUJBUyxJceukyZrtfFrBEnRXkyk52sHszm2XmqLPYvXWa8LFSHT7uxPBcRP/7aec6kk36AB61gL8QDbzKS62grvTx/9rCWix0SeSR0FHNXJJiixHeJ72AjBIn/ie/h03Xk2F8F7FfLhSPFdlM5fiVenD4vlvHexNAh2G/72rUP/mAzMRzvZ168s414aF9qw8yXpeu8HcbOTSphcaUk1Hhh1vP+n1nPO5r1TPv8QhXyTeYF96r8OMx1c+bOZh8vJIc5zewy1emkRl8vqT3v8f3lixLbNCf0Q1Ylw0e4SnGQ61QjiEgUkxi6AYEMHUO1AnyGJE5INCVB2L7Y3XSJiFb3a/ylllLiTw8H2tfl4XxQb2ENhFvBnonKuJB6DeVAIWbfI8m4HoI2GBjAZPtwg75XavN9VW9h4WWN2zl6LjAJdh/TfzjXxnOECr4A2kFzgvCYdepKO9QECjwSua3dT8LoIhphonfya0ASVWICwiaetIUotpBS5NlHQ4NAny4y9/Q4SDjMh1VgN/ICLuAjR9Dw42YORfr0ptEevMNVwF2iVoF+D01Cxg1sd4YFeFwELkDNyG9rqovLg9orYnTPZyl0sbZGt62dyu07QH3kVo+6sNqiHIx/rm/Uxzc0XRBDqNNU6EFDQTHiE6coPWLgkNsGJ+qWeLfeC2gtsPXAMV2XI17qYCRFlkLdVqbVUeU9AQnAf6XAThTYR+Bvjfm0pbLXr5U9a3CjW/5IqWw2X5pfvlYe3ufT8PbzMmDRPgPm6JfLIyn1/McKdLsv9+sveLp/kbDi/wA=&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="120" y="240" width="400" height="80" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 220 120 L 220 233.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 220 238.88 L 216.5 231.88 L 220 233.63 L 223.5 231.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="160" y="40" width="120" height="80" rx="12" ry="12" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 420.02 120 L 420.02 233.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 420.02 238.88 L 416.52 231.88 L 420.02 233.63 L 423.52 231.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="360" y="40" width="120" height="80" rx="12" ry="12" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="255" y="265" width="105" height="35" fill="#f5f5f5" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 103px; height: 1px; padding-top: 283px; margin-left: 256px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #333333; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">age = 42(主)</div></div></div></foreignObject><text x="308" y="286" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">age = 42(主)</text></switch></g><rect x="185" y="0" width="70" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 10px; margin-left: 186px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">thread1</div></div></div></foreignObject><text x="220" y="14" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">thread1</text></switch></g><rect x="385" y="0" width="70" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 10px; margin-left: 386px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">thread2</div></div></div></foreignObject><text x="420" y="14" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">thread2</text></switch></g><path d="M 280.1 66.26 L 333.8 66.3 L 333.75 254.9" fill="none" stroke="#ff0000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 273.35 66.25 L 282.36 61.76 L 280.1 66.26 L 282.35 70.76 Z" fill="#ff0000" stroke="#ff0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 333.75 261.65 L 329.25 252.64 L 333.75 254.9 L 338.25 252.65 Z" fill="#ff0000" stroke="#ff0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="172.5" y="52.5" width="97.5" height="27.5" fill="#f5f5f5" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 96px; height: 1px; padding-top: 66px; margin-left: 174px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #333333; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">age = 42(从)</div></div></div></foreignObject><text x="221" y="70" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">age = 42(从)</text></switch></g><rect x="0" y="40" width="100" height="40" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 60px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">工作内存</div></div></div></foreignObject><text x="50" y="64" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">工作内存</text></switch></g><rect x="10" y="260" width="100" height="40" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 280px; margin-left: 11px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">主内存</div></div></div></foreignObject><text x="60" y="284" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">主内存</text></switch></g><path d="M 221.3 110 Q 221.3 187.5 260.45 187.5 Q 299.6 187.5 299.62 256.89" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 299.62 263.64 L 295.12 254.64 L 299.62 256.89 L 304.12 254.64 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="172.5" y="87.5" width="97.5" height="22.5" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 96px; height: 1px; padding-top: 99px; margin-left: 174px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">age = 142</div></div></div></foreignObject><text x="221" y="102" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">age = 142</text></switch></g><rect x="371.25" y="52.5" width="97.5" height="27.5" fill="#f5f5f5" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 96px; height: 1px; padding-top: 66px; margin-left: 372px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #333333; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">age = 42(从)</div></div></div></foreignObject><text x="420" y="70" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">age = 42(从)</text></switch></g><rect x="530" y="33" width="380" height="147" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 378px; height: 1px; padding-top: 107px; margin-left: 531px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">如图所示：thread1 和 thread2 都拿到了主内存中的 age = 42，当 thread1 将 age 修改为 age = 142 时，thread2 是不知道的。这就是多线程环境下，线程可见性的问题。提供可见性的机制，就可以使 thread1 一旦做出修改，thread2 就可以知道。<br />volatile 关键字可以保证可见性。</div></div></div></foreignObject><text x="720" y="110" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">如图所示：thread1 和 thread2 都拿到了主内存中的 age = 42，当 thread1 将 age 修改为 age = 142 时，thread2 是不知道的。这就是多线程环境下，线程可见性的问题。提供可见性的机制，就可以使 thr...</text></switch></g><rect x="280" y="140" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 150px; margin-left: 281px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">CAS</div></div></div></foreignObject><text x="300" y="154" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">CAS</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>